<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="Article"> 
	<insert id ="insertOne" parameterType="HashMap">
		INSERT INTO TB_ARTICLE
		(TYPE_ITEM,
		TYPE_ARTICLE,
		DATE_LOST,
		DATE_UPLOAD,
		HOLD,
		PLACE,
		TITLE,
		CONTENTS,
		IMAGE,
		MEMBER_SEQ)
		VALUES
		(#{article.TYPE_ITEM},
		#{article.TYPE_ARTICLE},
		"test",
		#{article.DATE_UPLOAD},
		"0",
		#{article.PLACE},
		#{article.TITLE},
		#{article.CONTENTS},
		"test",
		(SELECT SEQ FROM TB_MEMBER
		WHERE NICKNAME=#{article.NICKNAME})
		)
	</insert>
	<update id = "updateHits" parameterType="HashMap">
		UPDATE TB_ARTICLE
		SET HITS=HITS+1
		WHERE SEQ = #{seq}
	</update>
	<select id = "searchByTitle" resultType="com.project.TheLostItemFinder.lostItem.service.ArticleDTO" parameterType="HashMap">
		SELECT
		A.SEQ, 
		A.TYPE_ITEM,
		A.TYPE_ARTICLE,
		A.DATE_LOST,
		A.DATE_UPLOAD,
		A.HOLD,
		M.NICKNAME,
		A.PLACE,
		A.TITLE,
		A.CONTENTS,
		A.IMAGE,
		A.HITS
		FROM TB_ARTICLE A
		INNER JOIN TB_MEMBER M 
		ON M.SEQ=A.MEMBER_SEQ
		WHERE A.TITLE LIKE #{search}
		ORDER BY A.SEQ DESC LIMIT 10
	</select>
	
	<select id = "searchByType" resultType="com.project.TheLostItemFinder.lostItem.service.ArticleDTO" parameterType="HashMap">
		SELECT
		A.SEQ, 
		A.TYPE_ITEM,
		A.TYPE_ARTICLE,
		A.DATE_LOST,
		A.DATE_UPLOAD,
		A.HOLD,
		M.NICKNAME,
		A.PLACE,
		A.TITLE,
		A.CONTENTS,
		A.IMAGE,
		A.HITS
		FROM TB_ARTICLE A
		INNER JOIN TB_MEMBER M 
		ON M.SEQ=A.MEMBER_SEQ
		WHERE A.TYPE_ITEM LIKE #{search}
		ORDER BY A.SEQ DESC LIMIT 10
	</select>
	
	<select id = "searchByTitleContext" resultType="com.project.TheLostItemFinder.lostItem.service.ArticleDTO" parameterType="HashMap">
		SELECT
		A.SEQ, 
		A.TYPE_ITEM,
		A.TYPE_ARTICLE,
		A.DATE_LOST,
		A.DATE_UPLOAD,
		A.HOLD,
		M.NICKNAME,
		A.PLACE,
		A.TITLE,
		A.CONTENTS,
		A.IMAGE,
		A.HITS
		FROM TB_ARTICLE A
		INNER JOIN TB_MEMBER M 
		ON M.SEQ=A.MEMBER_SEQ
		WHERE A.TITLE LIKE #{search}
		OR
		A.CONTENTS LIKE #{search}
		ORDER BY A.SEQ DESC LIMIT 10
	</select>
	
	<select id = "searchByPlace" resultType="com.project.TheLostItemFinder.lostItem.service.ArticleDTO" parameterType="HashMap">
		SELECT
		A.SEQ, 
		A.TYPE_ITEM,
		A.TYPE_ARTICLE,
		A.DATE_LOST,
		A.DATE_UPLOAD,
		A.HOLD,
		M.NICKNAME,
		A.PLACE,
		A.TITLE,
		A.CONTENTS,
		A.IMAGE,
		A.HITS
		FROM TB_ARTICLE A
		INNER JOIN TB_MEMBER M 
		ON M.SEQ=A.MEMBER_SEQ
		WHERE A.TITLE LIKE #{search}
		OR
		A.PLACE LIKE #{search}
		ORDER BY A.SEQ DESC LIMIT 10
	</select>
	
	<select id = "selectAll" resultType="com.project.TheLostItemFinder.lostItem.service.ArticleDTO">
		SELECT
		A.SEQ, 
		A.TYPE_ITEM,
		A.TYPE_ARTICLE,
		A.DATE_LOST,
		A.DATE_UPLOAD,
		A.HOLD,
		M.NICKNAME,
		A.PLACE,
		A.TITLE,
		A.CONTENTS,
		A.IMAGE,
		A.HITS
		FROM TB_ARTICLE A
		INNER JOIN TB_MEMBER M 
		ON M.SEQ=A.MEMBER_SEQ
		ORDER BY A.SEQ DESC LIMIT 10
	</select>
	<select id ="selectOne" parameterType="HashMap" resultType="com.project.TheLostItemFinder.lostItem.service.ArticleDTO">
		SELECT
		A.SEQ, 
		A.TYPE_ITEM,
		A.TYPE_ARTICLE,
		A.DATE_LOST,
		A.DATE_UPLOAD,
		A.HOLD,
		M.NICKNAME,
		A.PLACE,
		A.TITLE,
		A.CONTENTS,
		A.IMAGE,
		A.HITS
		FROM TB_ARTICLE A
		INNER JOIN TB_MEMBER M
		ON A.MEMBER_SEQ = M.SEQ
		WHERE A.SEQ=#{seq}
	</select>
	<delete id="deleteArticle" parameterType="int">
		DELETE
		FROM TB_ARTICLE
		WHERE
		SEQ=#{seq}
	</delete>
</mapper>
